<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DM Panel | Torch Bearers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body class="bg-dark text-light">

    <app-navbar active="dm"></app-navbar>

    <div class="container mt-4">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="text-warning">DM Panel</h1>
            <p class="text-muted">Manage character approvals and campaign</p>
        </div>

        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs border-warning mb-4" id="dmTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active text-light" id="pending-tab" data-bs-toggle="tab" data-bs-target="#pending" type="button">
                    Pending Characters <span class="badge bg-warning text-dark ms-1" id="pendingCount">0</span>
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link text-light" id="all-characters-tab" data-bs-toggle="tab" data-bs-target="#all-characters" type="button">
                    All Characters
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="dmTabsContent">
            <!-- Pending Characters Tab -->
            <div class="tab-pane fade show active" id="pending" role="tabpanel">
                <!-- Loading State -->
                <div id="pendingLoadingState" class="text-center py-5">
                    <div class="spinner-border text-warning" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-3">Loading pending characters...</p>
                </div>

                <!-- No Pending Characters -->
                <div id="noPendingState" class="text-center py-5 d-none">
                    <h4 class="text-warning">No Pending Characters</h4>
                    <p class="text-muted">All characters have been reviewed!</p>
                </div>

                <!-- Pending Characters Grid -->
                <div id="pendingCharactersContent" class="d-none">
                    <div class="row" id="pendingCharactersGrid">
                        <!-- Character cards will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- All Characters Tab -->
            <div class="tab-pane fade" id="all-characters" role="tabpanel">
                <!-- Loading State -->
                <div id="allLoadingState" class="text-center py-5">
                    <div class="spinner-border text-warning" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-3">Loading all characters...</p>
                </div>

                <!-- All Characters Content -->
                <div id="allCharactersContent" class="d-none">
                    <div class="table-responsive">
                        <table class="table table-dark table-hover">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Player</th>
                                    <th>Class</th>
                                    <th>Level</th>
                                    <th>Status</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="allCharactersTableBody">
                                <!-- Table rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Character Details Modal -->
    <div class="modal fade" id="characterDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content bg-dark border-warning">
                <div class="modal-header border-warning">
                    <h5 class="modal-title text-warning" id="characterDetailsTitle">Character Details</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="characterDetailsBody">
                    <!-- Character details will be inserted here -->
                </div>
                <div class="modal-footer border-warning">
                    <button type="button" class="btn btn-outline-warning" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-danger" id="rejectCharacterBtn">Reject</button>
                    <button type="button" class="btn btn-success" id="approveCharacterBtn">Approve</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reject Reason Modal -->
    <div class="modal fade" id="rejectReasonModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content bg-dark border-warning">
                <div class="modal-header border-warning">
                    <h5 class="modal-title text-warning">Reject Character</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="text-light">Character: <strong id="rejectCharacterName"></strong></p>
                    <div class="mb-3">
                        <label for="rejectReason" class="form-label text-light">Reason (optional)</label>
                        <textarea class="form-control bg-black text-light border-secondary" id="rejectReason" rows="3" placeholder="Why is this character being rejected?"></textarea>
                    </div>
                </div>
                <div class="modal-footer border-warning">
                    <button type="button" class="btn btn-outline-warning" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmRejectBtn">Reject Character</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap & Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/core/app.js"></script>
    <script src="/js/components/login-modal.js"></script>
    <script src="/js/components/register-modal.js"></script>
    <script src="/js/components/app-navbar.js"></script>
    <script src="/js/dm.js"></script>
</body>
</html>